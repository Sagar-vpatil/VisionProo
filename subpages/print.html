<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prescription</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
       
@media print {
     /* Ensure the Visual Acuity table does not split */
     #Visual-Acuity-Table {
        page-break-inside: avoid;
    }

    /* Ensure the AR table does not split */
    #AR-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Current Power table does not split */
    #Current-Power-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Refraction table does not split */
    #Refraction-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Eye Examination table does not split */
    #Eye-Examination-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Topography table does not split */
    #Topography-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Pre-Operative table does not split */
    #Pre-Operative-Table {
        page-break-inside: avoid;
    }

    /* Ensure the A-Scan table does not split */
    #A-Scan-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Medicines table does not split */
    #Medicines-Table {
        page-break-inside: avoid;
    }

    /* Ensure the Treatment section does not split */
    #Treatment-Heading, #Medicines-Heading, #Pre-Operative-Heading, #NCT-Heading, #A-Scan-Heading , #Visual-Acuity-Heading, #AR-Heading, #Current-Power-Heading, #Refraction-Heading, #Eye-Examination-Heading, #Topography-Heading {
        page-break-inside: avoid;
    }

    /* Ensure the Pre-Operative section does not split */
    .Pre-Operative-Details {
        page-break-inside: avoid;
    }


    /* Ensure the Eye Examination table does not split across pages */
    .eye-examination-section {
        page-break-inside: avoid; /* Prevent the table from splitting */
    }

    /* Ensure the Medicines Table does not split across pages */
    .medicines-section {
        page-break-inside: avoid; /* Prevent the table from splitting */
        margin-bottom: 10px; /* Add some spacing after the section */
    }

    /* Selective coloring for Medicines Table header during printing */
    #Medicines-Table thead th {
        background-color: #e0e0e0; /* Light gray background for the header */
        color: #000; /* Ensure text is black for readability */
    }

    /* Optional: Style for table rows for better readability */
    #Medicines-Table tbody tr {
        background-color: #f9f9f9; /* Very light gray for rows */
    }

    /* Adjust margins and padding for better printing */
    .page {
        margin: 0;
        padding: 0;
        width: 210mm;
        height: 297mm;
    }

    /* Hide unnecessary elements */
    .navbar, .print-btn, .buttons, .hr {
        display: none !important;
    }
}

       /* New CSS for the top navbar image */
       .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f8f8f8;
            padding: 5px 10px;
      
        }
        .navbar img {
            height: 50px; /* Adjust as needed */
            margin-left: 20px; /* Space between logo and other elements */
        }
        .navbar .buttons {
            display: flex;
            gap: 10px;
        }
        .navbar .buttons button {
            padding: 8px 16px;
            font-size: 14px;
            background: #d32f2f;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }



        .page {
            width: 90%;
            max-width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 20px auto;
            box-shadow: 0 0 5px rgba(5, 0, 0, 0.1);
            background: #fff;
           
            flex-direction: column;
            align-items: center;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid black;
            padding-bottom: 10px;
        }
        .header .left {
            text-align: left;
            font-size: 17px;
        }
        .header .right {
            text-align: right;
            font-size: 17px;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        .header p {
            margin: 5px 0;
        }
        .medicines {
            display: flex;
            border-top: 2px solid black;
            padding: 10px 0;
        }
        .medicines .left {
            width: 20%;
            padding-right: 10px;
            border-right: 2px solid black;
        }
        .medicines .right {
            width: 70%;
            padding-left: 10px;
            display: flex;
            flex-direction: column;
        }
        .patient-details {
            margin-top: 20px;
        }
        .patient-details h3 {
            font-size: 18px;
            font-weight: bold;
        }
        .patient-details p {
            font-size: 14px;
            margin: 5px 0;
        }
        .complaints {
            font-size: 18px;
            color: #333;
        }
        .medical-history, .surgical-history {
            font-size: 14px;
            margin-top: 10px;
            padding-left: 10px;
            padding-top: 5px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
        }
        .diagnosis-list,
        .investigation-list {
            margin-top: 5px;
        }
        .diagnosis-list h3,
        .investigation-list h3 {
            font-size: 18px;
        }
        .diagnosis-list ul,
        .investigation-list ul {
            list-style-type: none;
            padding-left: 0;
        }
        .diagnosis-list li,
        .investigation-list li {
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 2px;
         
            text-align: center; /* Center-align text horizontally */
            vertical-align: middle; /* Center-align text vertically */
        }
        th {
            color: #002D62;
            font-size: 16px;
            margin: 0px;
        }
        td {
            font-size: 14px;
        }
        @media print {
            .navbar .buttons button{
                display: none;
            }
            .hr{
                display: none;
            }
            .signature {
                text-align: right;
                font-style: italic;
            }
            .signature::before {
                content: "_______________";
                display: block;
                margin-bottom: 10px;
            }
            body {
                margin: 0;
                width: 210mm;
                height: 297mm;
            }
            .page {
                box-shadow: none;
                margin: 0;
                width: 210mm;
                height: 297mm;
            }
            .print-btn {
                display: none;
            }
            body {
        margin: 0;
        padding: 0;
        width: 210mm;
        height: 297mm;
    }
    .page {
        margin: 0;
        padding: 0;
        width: 210mm;
        height: 297mm;
        box-shadow: none;
    }
    @page {
        size: A4;

    }

        }
        .print-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .print-btn:hover {
            background: #45a049;
        }


        .heade {
            display: flex;
            align-items: center;
            justify-content: space-between;
          
            padding: 15px;
            border-bottom: 3px solid #120d0d;
        }
        .logo img {
            width: 190px;
            height: auto; /* Adjust as needed */
        }
        .hospital-name {
            color: red;
            font-size: 32px;
            font-weight: bold;
            font-family: 'Mangal', sans-serif;
            margin-left: 20px; /* Space between logo and name */
        }
        .sub-heading {
            text-align: center;
            font-size: 18px;
            color: #333;
            margin-top: 10px; /* Space between hospital name and subheading */
        }



        @media print {
    /* Hide unnecessary elements */
    .navbar, .print-btn, .buttons, .hr {
        display: none !important;
    }

    /* Ensure the body and page fit A4 size */
    body, .page {
        margin: 0;
        padding: 0;
       
        box-shadow: none;
    }}
/* Define A4 page size and margins explicitly */
@page {
    size: A4;
    margin: 4mm; /* Set a 10mm margin on all sides for the printable area */
}


        /* Print-specific styling */
        @media print {
          

          

            .advice-list ul {
                list-style-type: disc;
                margin-left: 5px; /* Adjust margin-left for print */
                padding-left: 10px; /* Reduce padding for print */
                font-size: 14px;
                color: #000;
            }

            .advice-list ul li {
                margin-bottom: 5px;
            }


        }

     /* Code For Show BP, Puls Rate And SAC Section in One Line */   
    .patient-details.Pre-Operative-Details {
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      align-items: center;
      gap: -10px; /* spacing between items */
    }
    .patient-details.Pre-Operative-Details p {
      margin: 0;
      white-space: nowrap; /* prevent text from wrapping */
    }




    @media print {
    /* Existing print styles */
    .eye-examination-section {
        page-break-inside: avoid;
    }

    .medicines-section {
        page-break-inside: avoid;
        margin-bottom: 10px;
    }

    /* New styles for vertical lines */
    .medicines .left {
        border-right: 1px solid black !important;
    }

    .medicines .right {
        border-left: 1px solid black !important;
    }

    /* Ensure tables and borders are visible */
    table, th, td {
        border: 1px solid black !important;
    }

    /* Hide unnecessary elements */
    .navbar, .print-btn, .buttons, .hr {
        display: none !important;
    }

    /* Ensure the body and page fit A4 size */
    body, .page {
        margin: 0;
        padding: 0;
        width: 210mm;
        height: 297mm;
        box-shadow: none;
    }

    /* Ensure the header and footer are visible */
    .footer {
        display: block !important;
    }

    /* Ensure the signature is visible */
    .signature {
        text-align: right;
        font-style: italic;
    }

    .signature::before {
        content: "_______________";
        display: block;
        margin-bottom: 10px;
    }
}


  /* Header Section */
  .letterhead {
        border-bottom: 2px solid #070a0d;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: relative; /* Added for positioning doctor names */
    }

    .hospital-logo {
        width: 160px;
        height: 110px;
    }

    .hospital-info {
        text-align: right;
    }

    .hospital-name {
        font-family: 'Helvetica Neue', sans-serif;
        font-weight: 700;
        color: red;
        font-size: 32px;
        letter-spacing: 1.5px;
    }

    .hospital-address {
        font-size: 18px;
        color: #666;
       
    }

    /* Doctor's Name Styling */
    .doctor-name-left,
    .doctor-name-right {
        position: absolute;
        top: 0;
        font-family: 'Helvetica Neue', sans-serif;
        font-size: 16px;
        font-weight: 500;
        color: #333;
    }

    .doctor-name-left {
        left: 0; /* Position on the left corner */
    }

    .doctor-name-right {
        right: 0; /* Position on the right corner */
    }

    .hospital-address-details {
        font-size: 17px;
        color: #100f0f;
        font-weight: bold;
        line-height: 1.5;
        margin: 1; /* Remove default margin */
    }
    </style>
</head>
<body>

 <!-- Top Navigation Bar -->
 <nav class="navbar">
    <!-- Logo and Hospital Name -->
    <div style="display: flex; align-items: center;">
       
      
    </div>
       
    </div>

    <!-- Image on the Right Side -->
    

    <!-- Action Buttons -->
    <div class="buttons" style="margin-bottom: 10px;">
        <button onclick="window.location.href='./main.html';">🏠 Home</button>
        <button onclick="printFunction()">🖨️ Print </button>
    </div>
</nav>
<hr class="hr">



    <div class="page">
        <div class="letterhead">
            <!-- Left Corner - Doctor's Name -->
            <div class="doctor-name-left" style="margin-top: 70px;">
                Dr. Alvin R. Rane.<br> M.S. (Netrarog)<br>
            </div>
        
            <!-- Hospital Logo and Info -->
            <div style="margin-left: 150px;">
                <img src="../assets/images/Ravikalp_Hospital__new_logo-removebg-preview.png" alt="Hospital Logo" class="hospital-logo">
            </div>
            <div class="hospital-info" style="margin-right: 26%; margin-bottom: 10px;">
                <div class="hospital-name">रविकल्प हॉस्पिटल</div>
                <div class="hospital-address" style="margin-right: 0px;">EYE & GENERAL HOSPITAL<br>PHACO & LASER CENTER</div>
            </div>
        
            <!-- Right Corner - Doctor's Name -->
            <div class="doctor-name-right" style="margin-top: 70px;">
                Dr. Selina A. Rane <br> M.D. (Ayu)<br>
            </div>
            
        </div>
        
<!-- Address Section -->
<div class="address-section">
    
    <p class="hospital-address-details">
        <i class="fa-solid fa-location-dot" style="font-size: 20px; width: 24px; height: 25px; margin-left: 30px; color: red;"></i> 518/1/6,Near Panchamukhi Hanuman Mandir Colony Road, Jalgaon | Phone: +91 9423902084
    </p>
    <hr style="border: 1px solid #070a0d;">
</div>
        <div class="header">
            <div class="left">
                <p><strong>Patient ID:</strong> <span id="patient-id"></span></p>
                <p><strong>Name:</strong> <span id="patient-name"></span></p>
                <p><strong>Age:</strong> <span id="patient-age"></span></p>
            </div>
            <div class="right">
                <p style="margin-right: 43px;"><strong>Date:</strong> <span id="appointment-date"></span></p>
                <p style="margin-left: 40px;"> <strong> Mobile No:
                    </strong  > <span id="patient-mobile">454548583</span></p>
              <p style="margin-right: 70px;"> <strong> Gender:</strong  > <span id="patient-gender"></span></p>
            </div>
            
        </div>

        <div class="medicines">
            <div class="left">
                <!-- <div class="diagnosis-list" style="margin-top: 20px;">
                    <h3>Diagnosis</h3>
                    <ul>
                       Diagnoses will be dynamically populated here -->
                    <!-- </ul>
                  </div> -->
                  
                <div class="investigation-list" >
                    <h3>Investigation </h3>
                    <ul>
                        <!-- Investigation will be dynamically populated here  -->
                      </ul>
                </div>
                <div class="investigation-list advice-list">
                <h3>Advice </h3>
                <ul>
                    <!-- Advice will be dynamically populated here  -->
                  </ul>
                </div>
            </div>
            
            <div class="right">
              
                    <p class="complaints show-symptoms" style="font-size: 16px; margin-top: 10px;"></p>

                   
                        <p class="complaints show-medical-history" style="font-size: 16px; margin-top: 10px;">
    
                        </p>
                    
                        <p class="complaints show-surgical-history" style="margin-right: 120px;">
                        </p>
                    
                

                <!-- Table Section -->
                <h3 id="Visual-Acuity-Heading">Visual Acuity</h3>
                <table style="margin-top: 0px; width: 280px; margin-left: 120px;" id="Visual-Acuity-Table" >
                    <thead>
                        <tr >
                            <th></th>
                            <th>Right Eye</th>
                            <th>Left Eye</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Unaided</td>
                            <td id="UnaidedR">0</td>
                            <td id="UnaidedL">0</td>
                        </tr>
                        <tr>
                            <td>Glasses</td>
                            <td id="GlassesR">0</td>
                            <td id="GlassesL">0</td>
                        </tr>
                        <tr>
                            <td>Near Vision</td>
                            <td id="NearVisionR">1</td>
                            <td id="NearVisionL">0</td>
                        </tr>
                        <tr>
                            <td>Pinhole Vision</td>
                            <td id="PinholeR">1</td>
                            <td id="PinholeL">0</td>
                        </tr>
                    </tbody>
                </table>

                <h3 id="AR-Heading">AR </h3>
                <table style="width: 450px; margin-left: 100px;" border="1" id="AR-Table">
                  <thead>
                    <tr>
                      <th colspan="5">Right Eye</th>
                      <th colspan="5">Left Eye</th>
                    </tr>
                    <tr>
                      <th>SPH</th>
                      <th>CYL</th>
                      <th>Axis</th>
                      <th>V/A</th>
                      <th>DV</th>
                      <th>SPH</th>
                      <th>CYL</th>
                      <th>Axis</th>
                      <th>V/A</th>
                      <th>DV</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="height: 30px;">
                      <td id="ARSPH"></td>
                      <td id="ARCYL"></td>
                      <td id="ARAxis"></td>
                      <td id="ARVA"></td>
                      <td id="ARDV"></td>
                      <td id="ARSPH2"></td>
                      <td id="ARCYL2"></td>
                      <td id="ARAxis2"></td>
                      <td id="ARVA2"></td>
                      <td id="ARDV2"></td>
                    </tr>
                    <tr>
                      <th colspan="2">IPD </th>
                      <td colspan="8" id="ARIPD"></td>
                    </tr>
                  </tbody>
                </table>
  



                <div class="form-step" id="step-3">
                    <div class="form-group">
                      <h3 id="Current-Power-Heading">Old Glass Power  </h3>
                      <div class="table-container" id="Current-Power-Section">
                        <table id="Current-Power-Table" style="width: 390px; margin-left: 90px;">
                          <thead>
                            <tr>
                              <th></th>
                              <th colspan="4">Right Eye</th>
                              <th colspan="4">Left Eye</th>
                            </tr>
                          </thead>
                          <thead>
                            <tr>
                              <th></th>
                              <th>SPH</th>
                              <th>CYL</th>
                              <th>Axis</th>
                              <th>V/A</th>
                              <th>SPH</th>
                              <th>CYL</th>
                              <th>Axis</th>
                              <th>V/A</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>DV</td>
                              <td id="DVSPH">+1.25</td>
                              <td id="DVCYL">-0.50</td>
                              <td id="DVAxis">90</td>
                              <td id="DVVA">6/6</td>
                              <td id="DVSPH2">+1.00</td>
                              <td id="DVCYL2">-0.75</td>
                              <td id="DVAxis2">80</td>
                              <td id="DVVA2">6/9</td>
                            </tr>
                            <tr>
                              <td>NV</td>
                              <td id="NVSPH">+2.00</td>
                              <td id="NVCYL">-1.00</td>
                              <td id="NVAxis">85</td>
                              <td id="NVVA">6/7.5</td>
                              <td id="NVSPH2">+1.75</td>
                              <td id="NVCYL2">-0.25</td>
                              <td id="NVAxis2">95</td>
                              <td id="NVVA2" >6/6</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <h3 id="Refraction-Heading">Refraction </h3>
                  <table id="Refraction-Table" style="width: 450px; margin-left: 60px;" >
                    <thead>
                      <tr>
                        <th rowspan="2"></th>
                        <th colspan="4">Right Eye</th>
                        <th colspan="4">Left Eye</th>
                      </tr>
                      <tr>
                        <th>SPH</th>
                        <th>CYL</th>
                        <th>Axis</th>
                        <th>V/A</th>
                        <th>SPH</th>
                        <th>CYL</th>
                        <th>Axis</th>
                        <th>V/A</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>Distance</td>
                        <td id="DistanceSPH">85</td>
                        <td id="DistanceCYL">7</td>
                        <td id="DistanceAxis">56</td>
                        <td id="DistanceVA">56</td>
                        <td id="DistanceSPH2">89</td>
                        <td id="DistanceCYL2">56</td>
                        <td id="DistanceAxis2">565</td>
                        <td id="DistanceVA2">8</td>
                      </tr>
                      <tr>
                        <td>Near</td>
                        <td id="NearSPH">8</td>
                        <td id="NearCYL">5</td>
                        <td id="NearAxis">5</td>
                        <td id="NearVA">9</td>
                        <td id="NearSPH2">96</td>
                        <td id="NearCYL2">5</td>
                        <td id="NearAxis2">23</td>
                        <td id="NearVA2">2</td>
                      </tr>
                      <!-- <tr>
                        <td>IPD (mm)</td>
                        <td id="REIPD" colspan="4"></td>
                        <td id="LEIPD" colspan="4"></td>
                      </tr> -->
                      <tr aria-rowspan="2">
                        <td>Type of Glass</td>
                        <td id="RETypeOfGlass" colspan="4"></td>
                        <td id="LETypeOfGlass" colspan="4"></td>
                      </tr>
                      <!-- <tr>
                        <td>Remark</td>
                        <td id="RERemark" colspan="4"></td>
                        <td id="LERemark" colspan="4"></td>
                      </tr> -->
                    </tbody>
                  </table>
                  
                
                  <div class="eye-examination-section">
                    <h3 id="Eye-Examination-Heading">Eye Examination</h3>
                    <table class="table-container table-responsive" style="width: 360px; margin-left: 90px;" id="Eye-Examination-Table">
                        <thead>
                            <tr>
                                <th scope="col"></th>
                                <th scope="col">Right Eye</th>
                                <th scope="col">Left Eye</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Eyelids & Adnexa</td>
                                <td id="EyelidsR"></td>
                                <td id="EyelidsL"></td>
                            </tr>
                            <tr>
                                <td>Conjunctiva</td>
                                <td id="ConjunctivaR"></td>
                                <td id="ConjunctivaL"></td>
                            </tr>
                            <tr>
                                <td>Sclera</td>
                                <td id="ScleraR"></td>
                                <td id="ScleraL"></td>
                            </tr>
                            <tr>
                                <td>Cornea</td>
                                <td id="CorneaR"></td>
                                <td id="CorneaL"></td>
                            </tr>
                            <tr>
                                <td>Anterior Chamber</td>
                                <td id="AnteriorR"></td>
                                <td id="AnteriorL"></td>
                            </tr>
                            <tr>
                                <td>Iris</td>
                                <td id="IrisR"></td>
                                <td id="IrisL"></td>
                            </tr>
                            <tr>
                                <td>Pupil</td>
                                <td id="PupilR"></td>
                                <td id="PupilL"></td>
                            </tr>
                            <tr>
                                <td>Lens</td>
                                <td id="LensR"></td>
                                <td id="LensL"></td>
                            </tr>
                            <tr>
                                <td>Fundus</td>
                                <td id="FundusR"></td>
                                <td id="FundusL"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 id="Topography-Heading">Topography</h3>
                <table border="1" style="width: 280px; margin-left: 120px;" id="Topography-Table">
                  <thead>
                    <tr>
                      <th></th>
                      <th colspan="2">Right Eye</th>
                      <th colspan="2">Left Eye</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>IOP</td>
                      <td id="RightIOP" style="width: 50px;"></td>
                      <td class="unit">mmHg</td>
                      <td id="LeftIOP"></td>
                      <td class="unit"  style="width: 50px;">mmHg</td>
                    </tr>
                    <tr>
                      <td>Pachymetry</td>
                      <td id="RightPachymetry"  style="width: 50px;"></td>
                      <td class="unit">µm</td>
                      <td id="LeftPachymetry"  style="width: 50px;"></td>
                      <td class="unit">µm</td>
                    </tr>
                    <tr>
                      <td>Steepest K</td>
                      <td id="RightSteepest"></td>
                      <td></td>
                      <td id="LeftSteepest"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>Flattest K</td>
                      <td id="RightFlattest"></td>
                      <td></td>
                      <td id="LeftFlattest"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>Av.K</td>
                      <td id="RightAv"></td>
                      <td></td>
                      <td id="LeftAv"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>Cly Power</td>
                      <td id="RightClyPower"></td>
                      <td></td>
                      <td id="LeftClyPower"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>Degree</td>
                      <td id="RightDegree"></td>
                      <td></td>
                      <td id="LeftDegree"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>KSI/KCI</td>
                      <td id="RightKSIKCI"></td>
                      <td></td>
                      <td id="LeftKSIKCI"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td>Schirmer Test</td>
                      <td id="RightSchirmerTest"></td>
                      <td></td>
                      <td id="LeftSchirmerTest"></td>
                      <td></td>
                    </tr>
                  </tbody>
                </table>

            
                <div id="section5" class="section">

                    <div class="patient-details">
                        
                            <p class="complaints show-diagnosis" style="font-size: 16px; margin-top: 10px;"></p>

                        
                    </div>

                    <h3 id="Treatment-Heading">Treatment -</h3>
                    <div class="medicines-section">
                        <h4 id="Medicines-Heading">Medical Treatment</h4>
                        <table class="table-container table-responsive" id="Medicines-Table" style="width: 400px; margin-left: 80px;">
                            <thead>
                                <tr>
                                    <th scope="col">Medicine Name</th>
                                    <th scope="col">Dose</th>
                                </tr>
                            </thead>
                            <tbody id="medicines-tbody">
                                <!-- Medicines will be dynamically inserted here -->
                                <tr>
                                    <td>Eye Drop A</td>
                                    <td>1 drop twice daily</td>
                                </tr>
                                <tr>
                                    <td>Tablet B</td>
                                    <td>500mg once daily</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Pre-Operative Treatment</h3>
                    <table class="table-container table-responsive" style="width: 600px; margin-left: 40px;" id="Pre-Operative-Medicine-Template">
                        <thead>
                          <tr>
                          
                            <th>Medicine</th>
                            <th>Dose</th>
                            <th>Instructions</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr id="Medicine1">
                            
                            <td>Tab.Diamox 250mg</td>
                            <td>(2)</td>
                            <td>ऑपेरेशन च्या आदल्या दिवशी रात्री जेवणानंतर 1 गोळी आणि ऑपरेशन च्या दिवशी सकाळी 6.00 वाजता येताना एक गोळी घेणे</td>
                          </tr>
                          <tr id="Medicine2">
                         
                            <td>Tropicacyl plus eye drop</td>
                            <td>(01)</td>
                            <td>(बाहुली मोठी करण्याचा ड्रॉप) ऑपेरेशन च्या दिवशी सकाळी 6.00 वाजल्यापासून ऑपेरेशन च्या डोळ्यात 3-4 वेळा 10-10 मिनिटांनी 2 -2 थेंब टाकणे...</td>
                          </tr>
                          <tr id="Medicine3">
                          
                            <td>Kaiflur GT eye drop</td>
                            <td>(01)</td>
                            <td>आज पासून दोन्ही डोळ्यामध्ये 4 वेळा एक एक थेंब टाकणे.</td>
                          </tr>
                        </tbody>
                      </table>


                     
                    <div class="patient-details">
                        

                        <p class="complaints show-treatment" style="margin-right: 120px;">
                            <span style="font-weight: bold; font-size: 24px;"> Treatment :</span> Eye Drops(med)
                        </p>
                    
                   </div>






                   <h4 id="Pre-Operative-Heading"> Pre-Operative Procedure </h4>
                   <div class="patient-details Pre-Operative-Details">
                        
                    <p class="complaints show-BP" style="margin-right: 120px;">
      
                    </p>

                    <p class="complaints show-Pulse-Rate" style="margin-right: 120px;">
                        
                    </p>
                    <p class="complaints show-SAC" style="margin-right: 120px;">
                        
                    </p>                                          
                  </div>

                    <table style="width: 370px; margin-left: 90px;" id="Pre-Operative-Table">
                        <h4 id="NCT-Heading"> NCT </h4>
                  
                        <thead>
                           
                          <tr>
                            <th colspan="2">Right Eye</th>
                            <th colspan="2">Left Eye</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td class="input-wrapper">
                              <span id="RightmmHg">Data</span>
                              <span>mmHg</span>
                            </td>
                            <td><span id="RightmmHgTime">00:00</span></td>
                            <td class="input-wrapper">
                              <span id="LeftmmHg">Data</span>
                              <span>mmHg</span>
                            </td>
                            <td><span id="LeftmmHgTime">00:00</span></td>
                          </tr>
                        </tbody>
                      </table>

                      <h4 id="A-Scan-Heading">A-Scan </h4>
                      <table style="width: 280px; margin-left: 90px;" id="A-Scan-Table">
                        <thead>
                          <tr>
                            <th></th>
                            <th>Right Eye</th>
                            <th>Left Eye</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>K1</td>
                            <td id="RightK1"><span>Data</span></td>
                            <td id="LeftK1"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>K2</td>
                            <td id="RightK2"><span>Data</span></td>
                            <td id="LeftK2"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>LT</td>
                            <td id="RightLT"><span>Data</span></td>
                            <td id="LeftLT"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>AL</td>
                            <td id="RightAL"><span>Data</span></td>
                            <td id="LeftAL"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>ACD</td>
                            <td id="RightACD"><span>Data</span></td>
                            <td id="LeftACD"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>L.Power</td>
                            <td id="RightLPower"><span>Data</span></td>
                            <td id="LeftLPower"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>A.Constant</td>
                            <td id="RightAConstant"><span>Data</span></td>
                            <td id="LeftAConstant"><span>Data</span></td>
                          </tr>
                          <tr>
                            <td>IOL</td>
                            <td id="RightIOL"><span>Data</span></td>
                            <td id="LeftIOL"><span>Data</span></td>
                          </tr>
                        </tbody>
                      </table>
                    
              

                  

                </div>
                
            </div>
            
        </div>

        <div class="footer" style="color: black;">
            <div class="signature" style="margin-right: 30px;">
                <p>Dr. Alvin R Rane</p>
            </div>
        </div>
    </div>

    
     <script>
        const tempDateStr = localStorage.getItem("tempDate");
        function printFunction() {
            const patientId = "P"+appointment.id;
            // Get today's date in dd-mm-yyyy format

            let today;
            if (tempDateStr) {
                today = new Date(...tempDateStr.split("/").reverse().map((v, i) => (i === 1 ? v - 1 : +v)));
            } else {
                today = new Date(); // Ensure `today` is always a Date object
            }
            const date = today.toLocaleDateString("en-GB").replace(/\//g, "-");
            const Docname = patientId+"_HistorySlip" + "_" + date;

            console.log(patientId,date,Docname);

            window.electronAPI.printPage(patientId, date, Docname);
        }

        // Load the appointment details from localStorage

        // Retrieve the appointment object from localStorage
        const appointment = JSON.parse(window.localStorage.getItem("appointment"));

        // Populate the fields with the data
        if (appointment) {
            document.getElementById("patient-name").textContent = appointment.Name || "N/A";
            document.getElementById("patient-id").textContent = appointment.id || "N/A";
            document.getElementById("patient-age").textContent = appointment.Age ? appointment.Age + " yrs" : "N/A";
            document.getElementById("patient-gender").textContent = appointment.Gender || "N/A";
            document.getElementById("patient-mobile").textContent = appointment.MobileNo || "N/A";
        }

        // Get today's date in the desired format (e.g., DD/MM/YYYY)
        const today = new Date();
        const formattedDate = `${today.getDate().toString().padStart(2, '0')}/${(today.getMonth() + 1).toString().padStart(2, '0')}/${today.getFullYear()}`;

        // Populate the date field
        document.getElementById("appointment-date").textContent = formattedDate;

       // Load the selected symptoms from local storage
       const selectedSymptoms = JSON.parse(localStorage.getItem("selectedSymptoms")) || [];

       const complaintsSection = document.querySelector(".show-symptoms");
       if (selectedSymptoms.length === 0) {
       // Hide the complaints section if no symptoms are selected
       complaintsSection.style.display = "none";
       } else {
       // Show the complaints section and update the content
       complaintsSection.style.display = "block";
       complaintsSection.innerHTML = `
           <span style="font-weight: bold; font-size: 17px;">Complaints/Symptoms:</span> 
          ${selectedSymptoms.join(' <span style="font-weight: bold; color: black;">|</span> ')}

       `;
       }

       // Load the selected medicalHistory from local storage
       const selectedMedicalHistory = JSON.parse(localStorage.getItem("selectedMedicalHistory")) || [];
       const medicalHistorySection = document.querySelector(".show-medical-history");

       if (selectedMedicalHistory.length === 0) {
          // Hide the medical history section if no history is selected
          medicalHistorySection.style.display = "none";
        } else {
          // Show the medical history section and update the content
          medicalHistorySection.style.display = "block";
          medicalHistorySection.innerHTML = `
              <span style="font-weight: bold; font-size: 17px;">Medical History:</span> 
              ${selectedMedicalHistory.join(' <span style="font-weight: bold; color: black;">|</span> ')}
          `;
        }


        // Load the selected surgicalHistory from local storage
        const selectedSurgicalHistory = JSON.parse(localStorage.getItem("selectedSurgicalHistory")) || [];
        const surgicalHistorySection = document.querySelector(".show-surgical-history");

        if (selectedSurgicalHistory.length === 0) {
            // Hide the surgical history section if no history is selected
            surgicalHistorySection.style.display = "none";
        } else {
            // Show the surgical history section and update the content
            surgicalHistorySection.style.display = "block";
            surgicalHistorySection.innerHTML = `
                <span style="font-weight: bold; font-size: 17px;">Surgical History:</span> 
                ${selectedSurgicalHistory.join(' <span style="font-weight: bold; color: black;">|</span> ')}
            `;
        }



       // Load the diagnosis list from local storage
        const selectedDiagnosis = JSON.parse(localStorage.getItem("selectedDiagnosis")) || [];
        const diagnosisSection = document.querySelector(".show-diagnosis");

        if(selectedDiagnosis.length === 0) {
            // Hide the diagnosis section if no diagnosis is selected
            diagnosisSection.style.display = "none";
        } else {
            // Show the diagnosis section and update the content
            diagnosisSection.style.display = "block";
            diagnosisSection.innerHTML = `
                <span style="font-weight: bold; font-size: 17px;">Diagnosis:</span> 
                ${selectedDiagnosis.join(' <span style="font-weight: bold; color: black;">|</span> ')}
            `;
        }

        

    //    const diagnosisSection = document.querySelector(".diagnosis-list");
    //    const diagnosisList = diagnosisSection.querySelector("ul");

    //    if (selectedDiagnosis.length === 0) {
    //         // Hide the diagnosis section if no diagnoses are selected
    //         diagnosisSection.style.display = "none";
    //     } else {
    //         // Show the diagnosis section and update the list
    //         diagnosisSection.style.display = "block";

    //         // Clear the existing list
    //         diagnosisList.innerHTML = "";

    //         // Add each diagnosis as a list item
    //         selectedDiagnosis.forEach((diagnosis) => {
    //         const listItem = document.createElement("li");
    //         listItem.textContent = diagnosis;
    //         diagnosisList.appendChild(listItem);
    //         });
    //     }


       // Load the investigation list from local storage
         const selectedInvestigations = JSON.parse(localStorage.getItem("selectedInvestigation")) || [];
         const investigationSection = document.querySelector(".investigation-list");
         const investigationList = investigationSection.querySelector("ul");

            if (selectedInvestigations.length === 0) {
                // Hide the investigation section if no investigations are selected
                investigationSection.style.display = "none";
            } else {
                // Show the investigation section and update the list
                investigationSection.style.display = "block";
    
                // Clear the existing list
                investigationList.innerHTML = "";
    
                // Add each investigation as a list item
                selectedInvestigations.forEach((investigation) => {
                const listItem = document.createElement("li");
                listItem.textContent = investigation;
                investigationList.appendChild(listItem);
                });
            }

        // Load the advice list from local storage
        const selectedAdvice = JSON.parse(localStorage.getItem("selectedAdvices")) || [];
        const adviceSection = document.querySelector(".advice-list");
        const adviceList = adviceSection.querySelector("ul");

        if (selectedAdvice.length === 0) {
            // Hide the advice section if no advice is selected
            adviceSection.style.display = "none";
        } else {
            // Show the advice section and update the list
            adviceSection.style.display = "block";

            // Clear the existing list
            adviceList.innerHTML = "";

            // Add each advice as a list item
            selectedAdvice.forEach((advice) => {
            const listItem = document.createElement("li");
            listItem.textContent = advice;
            listItem.style.listStyleType = "disc"; // Add bullet points
            adviceList.appendChild(listItem);
            });
        }


        // Load the Treatment list from local storage
        const selectedMedicationTreatment = JSON.parse(localStorage.getItem("selectedMedicationTreatment")) || [];
        const selectedSurgicalTreatment = JSON.parse(localStorage.getItem("selectedSurgicalTreatment")) || [];
        const treatmentSection = document.querySelector(".show-treatment");

        // Check if there are any treatments selected
        if (selectedMedicationTreatment.length === 0 && selectedSurgicalTreatment.length === 0) {
            treatmentSection.style.display = "none";
        } else {
            treatmentSection.style.display = "block";
            
            let content = `<span style="font-weight: bold; font-size: 17px; color: black;"> Treatment Surgical :-</span>`;

            if (selectedMedicationTreatment.length > 0) {
                content += `<span style="font-weight: bold; font-size: 17px;"> Medication :</span> 
                            ${selectedMedicationTreatment.join(' <span style="font-weight: bold; color: black;">|</span> ')}<br>`;
            }

            if (selectedSurgicalTreatment.length > 0) {
                content += ` 
                            ${selectedSurgicalTreatment.join(' <span style="font-weight: bold; color: black;">|</span> ')}`;
            }

            treatmentSection.innerHTML = content;
        }




       // Load the vision table from local storage

       const visionTable = JSON.parse(localStorage.getItem("visionTable")) || {};

        const table = document.getElementById("Visual-Acuity-Table");
        const heading = document.getElementById("Visual-Acuity-Heading");
        const rows = table.querySelectorAll("tbody tr");

        // Define the mapping for each row and its respective keys in visionTable
        const rowMapping = [
            { rowIndex: 0, rightKey: "UnaidedR", leftKey: "UnaidedL" },
            { rowIndex: 1, rightKey: "GlassesR", leftKey: "GlassesL" },
            { rowIndex: 2, rightKey: "NearVisionR", leftKey: "NearVisionL" },
            { rowIndex: 3, rightKey: "PinholeR", leftKey: "PinholeL" },
        ];

        let visibleRowCount = 0;

        rowMapping.forEach(({ rowIndex, rightKey, leftKey }) => {
            const rightValue = visionTable[rightKey] || "";
            const leftValue = visionTable[leftKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
            rows[rowIndex].style.display = "none";
            } else {
            rows[rowIndex].style.display = ""; // Ensure it's visible if not empty
            rows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "0";
            rows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "0";
            visibleRowCount++;
            }
        });

        // Show or hide the entire table if all rows are hidden
        table.style.display = visibleRowCount > 0 ? "table" : "none";

        // Show or hide the heading based on whether the table is visible
        heading.style.display = visibleRowCount > 0 ? "block" : "none";


        // Load the current power table from local storage

        const currentPowerGlasses = JSON.parse(localStorage.getItem("currentPowerGlasses")) || {};

        const currentPowerSection = document.getElementById("Current-Power-Section");
        const currentPowerHeading = document.getElementById("Current-Power-Heading");
        console.log(currentPowerGlasses);
        // Check if all values in currentPowerGlasses are empty
        const allEmpty = Object.values(currentPowerGlasses).every(value => value === "");
        if (allEmpty) {
            // Hide the entire section if all values are empty
            currentPowerSection.style.display = "none";
            currentPowerHeading.style.display = "none";
        } else {
            // Show the section and update the table
            currentPowerSection.style.display = "block";
            currentPowerHeading.style.display = "block";

            // Update each cell in the table with the corresponding value
            Object.entries(currentPowerGlasses).forEach(([key, value]) => {
            const cell = currentPowerSection.querySelector(`#${key}`);
            cell.textContent = value || "";
            });
        }



        // Load the eye examination table from local storage
        const eyeExaminationTable = JSON.parse(localStorage.getItem("eyeExaminationTable")) || {};

        // Get table and heading elements
        const eyeTable = document.getElementById("Eye-Examination-Table");
        const eyeHeading = document.getElementById("Eye-Examination-Heading");
        const eyeRows = eyeTable.querySelectorAll("tbody tr");

        // Define the mapping for each row and its respective keys in eyeExaminationTable
        const eyeRowMapping = [
            { rowIndex: 0, rightKey: "EyelidsR", leftKey: "EyelidsL" },
            { rowIndex: 1, rightKey: "ConjunctivaR", leftKey: "ConjunctivaL" },
            { rowIndex: 2, rightKey: "ScleraR", leftKey: "ScleraL" },
            { rowIndex: 3, rightKey: "CorneaR", leftKey: "CorneaL" },
            { rowIndex: 4, rightKey: "AnteriorR", leftKey: "AnteriorL" },
            { rowIndex: 5, rightKey: "IrisR", leftKey: "IrisL" },
            { rowIndex: 6, rightKey: "PupilR", leftKey: "PupilL" },
            { rowIndex: 7, rightKey: "LensR", leftKey: "LensL" },
            { rowIndex: 8, rightKey: "FundusR", leftKey: "FundusL" }
        ];

        let visibleEyeRowCount = 0;

        eyeRowMapping.forEach(({ rowIndex, rightKey, leftKey }) => {
            const rightValue = eyeExaminationTable[rightKey] || "";
            const leftValue = eyeExaminationTable[leftKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                eyeRows[rowIndex].style.display = "none";
            } else {
                eyeRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                eyeRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "N/A";
                eyeRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "N/A";
                visibleEyeRowCount++;
            }
        });

        // Show or hide the entire table if all rows are hidden
        eyeTable.style.display = visibleEyeRowCount > 0 ? "table" : "none";

        // Show or hide the heading based on whether the table is visible
        eyeHeading.style.display = visibleEyeRowCount > 0 ? "block" : "none";



        // Load refraction table data from local storage
        const refractionTable = JSON.parse(localStorage.getItem("refractionTable")) || {};

        // Get the Refraction Table section and heading
        const refractionSection = document.getElementById("Refraction-Table");
        const refractionHeading = document.getElementById("Refraction-Heading");

        console.log(refractionTable);

        // Check if all values in refractionTable are empty
        const allEmptyRefraction = Object.values(refractionTable).every(value => value === "");
        if (allEmptyRefraction) {
            // Hide the entire section if all values are empty
            refractionSection.style.display = "none";
            refractionHeading.style.display = "none";
        } else {
            // Show the section and update the table
            refractionSection.style.display = "table";
            refractionHeading.style.display = "block";

            // Update each cell in the table with the corresponding value
            Object.entries(refractionTable).forEach(([key, value]) => {
                const cell = document.getElementById(key);
                if (cell) {
                    cell.textContent = value || "-"; // Default to "-" if value is empty
                }
            });
        }


        // Load the topography table from local storage
        const topographyTable = JSON.parse(localStorage.getItem("topographyTable")) || {};

        // Get table and heading elements
        const topographyTableElement = document.getElementById("Topography-Table");
        const topographyHeading = document.getElementById("Topography-Heading");
        const topographyRows = topographyTableElement.querySelectorAll("tbody tr");

        // Define the mapping for each row and its respective keys in topographyTable
        const topographyRowMapping = [
            { rowIndex: 0, rightKey: "RightIOP", leftKey: "LeftIOP" },
            { rowIndex: 1, rightKey: "RightPachymetry", leftKey: "LeftPachymetry" },
            { rowIndex: 2, rightKey: "RightSteepest", leftKey: "LeftSteepest" },
            { rowIndex: 3, rightKey: "RightFlattest", leftKey: "LeftFlattest" },
            { rowIndex: 4, rightKey: "RightAv", leftKey: "LeftAv" },
            { rowIndex: 5, rightKey: "RightClyPower", leftKey: "LeftClyPower" },
            { rowIndex: 6, rightKey: "RightDegree", leftKey: "LeftDegree" },
            { rowIndex: 7, rightKey: "RightKSIKCI", leftKey: "LeftKSIKCI" },
            { rowIndex: 8, rightKey: "RightSchirmerTest", leftKey: "LeftSchirmerTest" }
        ];

        let visibleTopographyRowCount = 0;

        topographyRowMapping.forEach(({ rowIndex, rightKey, leftKey }) => {
            const rightValue = topographyTable[rightKey] || "";
            const leftValue = topographyTable[leftKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                topographyRows[rowIndex].style.display = "none";
            } else {
                topographyRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                topographyRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "-";
                topographyRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "-";
                visibleTopographyRowCount++;
            }
        });

        // Show or hide the entire table if all rows are hidden
        topographyTableElement.style.display = visibleTopographyRowCount > 0 ? "table" : "none";

        // Show or hide the heading based on whether the table is visible
        topographyHeading.style.display = visibleTopographyRowCount > 0 ? "block" : "none";



        
        // Load AR table data from local storage
        const arTable = JSON.parse(localStorage.getItem("arTable")) || {};

        // Get AR table and heading elements
        const arTableElement = document.getElementById("AR-Table");
        const arHeading = document.getElementById("AR-Heading");

        // Get all rows in the AR table body
        const arRows = arTableElement.querySelectorAll("tbody tr");

        // Define row mappings
        const arRowMappings = [
            { rowIndex: 0, keys: ["ARSPH", "ARCYL", "ARAxis", "ARVA", "ARDV", "ARSPH2", "ARCYL2", "ARAxis2", "ARVA2", "ARDV2"] },
            { rowIndex: 1, keys: ["ARIPD"] } // Second row for IPD
        ];

        let visibleARRowCount = 0;

        // Iterate through each row mapping and update table cells
        arRowMappings.forEach(({ rowIndex, keys }) => {
            let isRowEmpty = true; // Assume the row is empty initially

            keys.forEach(key => {
                const cell = document.getElementById(key);
                const value = arTable[key]?.trim() || ""; // Trim to handle whitespace

                if (cell) {
                    cell.textContent = value || "-"; // Set value, default to "N/A"

                    // Check if at least one value is not empty
                    if (value) {
                        isRowEmpty = false;
                    }
                }
            });

            // Hide row if all values are empty
            if (isRowEmpty) {
                arRows[rowIndex].style.display = "none";
            } else {
                arRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                visibleARRowCount++;
            }
        });

        // Show or hide the entire table based on row visibility
        arTableElement.style.display = visibleARRowCount > 0 ? "table" : "none";
        arHeading.style.display = visibleARRowCount > 0 ? "block" : "none";


       


        // Load the medicines table from local storage
        const medicines = JSON.parse(localStorage.getItem("medicines")) || [];

        const medicinesTable = document.getElementById("Medicines-Table");
        const medicinesTbody = medicinesTable.querySelector("tbody");
        const medicinesHeading = document.getElementById("Medicines-Heading");

        if (medicines.length === 0) {
            // Hide the table if no medicines are selected
            medicinesTable.style.display = "none";
            medicinesHeading.style.display = "none";

        } else {
            // Show the table and update the content
            medicinesTable.style.display = "table";

            // Clear the existing table body
            medicinesTbody.innerHTML = "";

            // Add each medicine as a row in the table
            medicines.forEach((medicine) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${medicine.medicineSelect || "-"}</td>
                    <td>${medicine.medicineDose || "-"}</td>
                   
                `;
                medicinesTbody.appendChild(row);
            });
        }

        // Load the A-Scan table from local storage like eye examination table
        const aScanTable = JSON.parse(localStorage.getItem("aScanTable")) || {};
        
        // Get table and heading elements
        const aScanTableElement = document.getElementById("A-Scan-Table");
        const aScanHeading = document.getElementById("A-Scan-Heading");
        const aScanRows = aScanTableElement.querySelectorAll("tbody tr");

        // Define the mapping for each row and its respective keys in aScanTable
        const aScanRowMapping = [
            { rowIndex: 0, rightKey: "RightK1", leftKey: "LeftK1" },
            { rowIndex: 1, rightKey: "RightK2", leftKey: "LeftK2" },
            { rowIndex: 2, rightKey: "RightLT", leftKey: "LeftLT" },
            { rowIndex: 3, rightKey: "RightAL", leftKey: "LeftAL" },
            { rowIndex: 4, rightKey: "RightACD", leftKey: "LeftACD" },
            { rowIndex: 5, rightKey: "RightLPower", leftKey: "LeftLPower" },
            { rowIndex: 6, rightKey: "RightAConstant", leftKey: "LeftAConstant" },
            { rowIndex: 7, rightKey: "RightIOL", leftKey: "LeftIOL" }
        ];

        let visibleAScanRowCount = 0;

        aScanRowMapping.forEach(({ rowIndex, rightKey, leftKey }) => {
            const rightValue = aScanTable[rightKey] || "";
            const leftValue = aScanTable[leftKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                aScanRows[rowIndex].style.display = "none";
            } else {
                aScanRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                aScanRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "-";
                aScanRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "-";
                visibleAScanRowCount++;
            }
        });


        // Show or hide the entire table if all rows are hidden
        aScanTableElement.style.display = visibleAScanRowCount > 0 ? "table" : "none";

        // Show or hide the heading based on whether the table is visible
        aScanHeading.style.display = visibleAScanRowCount > 0 ? "block" : "none";


        // Load PreOperativeDetails data from local storage
        const preOperativeDetails = JSON.parse(localStorage.getItem("PreOperativeDetails")) || {};

        // Define field mappings
        const fieldMappings = [
            { key: "BPResult", className: "show-BP", label: "BP" },
            { key: "PulseRate", className: "show-Pulse-Rate", label: "P" },
        ];

        let visibleCount = 0;

        // Iterate through each field and update the content
        fieldMappings.forEach(({ key, className, label }) => {
            const element = document.querySelector(`.${className}`);

            if (element) {
                const value = preOperativeDetails[key]?.trim() || ""; // Trim to remove whitespace

                if (value) {
                    element.innerHTML = `<span style="font-weight: bold; font-size: 17px;">${label} :</span> ${value}`;
                    visibleCount++;
                } else {
                    element.style.display = "none"; // Hide element if value is empty
                }
            }
        });

        if (!preOperativeDetails.SACResultRE && !preOperativeDetails.SACResultLE) {
            document.querySelector(".show-SAC").style.display = "none";
        }
        else {
            let sacContent = `<span style="font-weight: bold; font-size: 17px;">SAC :</span>`;
            if (preOperativeDetails.SACResultRE) {
                sacContent += ` <span style="font-weight: bold; font-size: 15px;">RE - </span>${preOperativeDetails.SACResultRE}`;
            }
            if (preOperativeDetails.SACResultLE) {
                if (preOperativeDetails.SACResultRE) {
                    sacContent += ` <span style="font-weight: bold; font-size: 17px;">|</span>`;
                }
                sacContent += ` <span style="font-weight: bold; font-size: 15px;">LE -</span> ${preOperativeDetails.SACResultLE}`;
            }
            document.querySelector(".show-SAC").innerHTML = sacContent;
            visibleCount++;
        }

        // Hide the entire section if no details are available
        const patientDetailsSection = document.querySelector(".Pre-Operative-Details");
        if (visibleCount === 0 && patientDetailsSection) {
            patientDetailsSection.style.display = "none";
        }
        

        // Load IOP/GAT data from local storage like eye examination table
        const iopGatTable = JSON.parse(localStorage.getItem("iopGatTable")) || {};

        // Get table and heading elements
        const iopGatTableElement = document.getElementById("Pre-Operative-Table");
        const iopGatHeading = document.getElementById("NCT-Heading");

        // Get all rows in the IOP/GAT table body
        const iopGatRows = iopGatTableElement.querySelectorAll("tbody tr");

        // Define row mappings
        const iopGatRowMappings = [
            { rowIndex: 0, rightKey: "RightmmHg", rightTimeKey: "RightmmHgTime", leftKey: "LeftmmHg", leftTimeKey: "LeftmmHgTime" }
        ];

        let visibleIopGatRowCount = 0;

        // Iterate through each row mapping and update table cells

        iopGatRowMappings.forEach(({ rowIndex, rightKey, rightTimeKey, leftKey, leftTimeKey }) => {
            const rightValue = iopGatTable[rightKey] || "";
            const rightTimeValue = iopGatTable[rightTimeKey] || "";
            const leftValue = iopGatTable[leftKey] || "";
            const leftTimeValue = iopGatTable[leftTimeKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                iopGatRows[rowIndex].style.display = "none";
            } else {
                iopGatRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                iopGatRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "-";
                iopGatRows[rowIndex].querySelector(`#${rightTimeKey}`).textContent = rightTimeValue || "-";
                iopGatRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "-";
                iopGatRows[rowIndex].querySelector(`#${leftTimeKey}`).textContent = leftTimeValue || "-";
                visibleIopGatRowCount++;
            }
        });

        // Show or hide the entire table based on row visibility
        iopGatTableElement.style.display = visibleIopGatRowCount > 0 ? "table" : "none";
        iopGatHeading.style.display = visibleIopGatRowCount > 0 ? "block" : "none";


        // Hide Pre-Operative-Heading if iopGatTable, preOperativeDetails and aScanTable are empty
        if (visibleIopGatRowCount === 0 && visibleCount === 0 && visibleAScanRowCount === 0) {
            document.getElementById("Pre-Operative-Heading").style.display = "none";
        }

        // Hide Treatment-Heading if Medicines-Table, selectedSurgicalTreatment, iopGatTable, preOperativeDetails and aScanTable are empty
        if (medicines.length === 0 && selectedSurgicalTreatment.length === 0 && visibleIopGatRowCount === 0 && visibleCount === 0 && visibleAScanRowCount === 0) {
            document.getElementById("Treatment-Heading").style.display = "none";
        }


        const preOperativeTemplate = JSON.parse(localStorage.getItem("preOperativeTemplate")) || {};
        const pre_Operative_Medicine_Table = document.getElementById("Pre-Operative-Medicine-Template");
        const preOperativeRows = pre_Operative_Medicine_Table.querySelectorAll("tbody tr");

        // Function to update the visibility of rows based on preOperativeTemplate
        function updateTableVisibility() {
            let isAnyRowVisible = false;

            preOperativeRows.forEach(row => {
                const medicineId = row.id; // Example: "Medicine1", "Medicine2", etc.

                if (preOperativeTemplate[medicineId] === "true") {
                    row.style.display = ""; // Show row
                    isAnyRowVisible = true;
                } else {
                    row.style.display = "none"; // Hide row
                }
            });

            // Hide entire table if no rows are visible or template is empty
            if (!isAnyRowVisible || Object.keys(preOperativeTemplate).length === 0) {
                pre_Operative_Medicine_Table.style.display = "none";
            } else {
                pre_Operative_Medicine_Table.style.display = ""; // Show table if any row is visible
            }
        }

       updateTableVisibility();

        const Saved_Status = localStorage.getItem("Saved_Status");
        console.log(Saved_Status);
        if(Saved_Status === "true" || Saved_Status){
            console.log("Saved_Status is true");
             // Clear the Local Storage variables
        localStorage.removeItem("tempDate");
        localStorage.removeItem("selectedSymptoms");
        localStorage.removeItem("selectedDiagnosis");
        localStorage.removeItem("selectedMedicalHistory");
        localStorage.removeItem("selectedSurgicalHistory");
        localStorage.removeItem("selectedInvestigation");
        localStorage.removeItem("selectedAdvices");
        localStorage.removeItem("selectedMedicationTreatment");
        localStorage.removeItem("selectedSurgicalTreatment");
        localStorage.removeItem("visionTable");
        localStorage.removeItem("currentPowerGlasses");
        localStorage.removeItem("eyeExaminationTable");
        localStorage.removeItem("refractionTable");
        localStorage.removeItem("topographyTable");
        localStorage.removeItem("arTable");
        localStorage.removeItem("medicines");
        localStorage.removeItem("PreOperativeDetails");
        localStorage.removeItem("aScanTable");
        localStorage.removeItem("iopGatTable");
        localStorage.removeItem("preOperativeTemplate");
        localStorage.removeItem("postOperativeTemplate");
        localStorage.removeItem("openHistory_Status");
        localStorage.removeItem("Saved_Status");
        }
     </script>
</body>
</html>
