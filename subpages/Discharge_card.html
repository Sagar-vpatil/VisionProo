<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discharge Summary - Professional Print Layout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>

        /* Investigation Section Styling */
.investigation-container {
    margin-top: 20px;
    text-align: center;
}

.investigation-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    align-items: center;
}

.investigation-item {
    display: flex;
    align-items: center;
    gap: px;
}

.investigation-item span {
    font-weight: bold;
}

.investigation-item input {
    width: 100px; /* Adjust width as needed */
    padding: 5px;
    font-size: 14px;
    border: 1px solid #ddd;
    border-radius: 4px;
    text-align: center;
}
           /* Base Styling */
           @page {
            size: A4;
            margin: 0;
        }
        .small-input {
        width: 80px; /* Adjust width */
        padding: 5px;
        font-size: 14px;
        border: 1px solid #ddd;
        border-radius: 4px;
        text-align: center;
        margin: 0 5px;
    }
        .container {
            max-width: 210mm; /* A4 width */
            min-height: 297mm; /* A4 height */
            margin: 0 auto;
            padding: 30px;
            position: relative;
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        /* Header Section */
        .letterhead {
            border-bottom: 2px solid #004a99;
            padding-bottom: 15px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .hospital-logo {
            width: 160px;
            height: 110px;
        }

        .hospital-info {
            text-align: right;
        }

        .hospital-name {
            font-family: 'Helvetica Neue', sans-serif;
            font-weight: 700;
            color: red;
            font-size: 32px;
            letter-spacing: 1.5px;
        }

        .hospital-address {
            font-size: 18px;
            color: #666;
        }

        /* Patient Information */
        

        .patient-table {
            width: 100%;
            border-collapse: collapse;
        }

        .patient-table th, .patient-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center; /* Center-align text horizontally */
            vertical-align: middle; /* Center-align text vertically */
        }

        .patient-table th {
            color: #000;
            text-align: left;
        }

        /* Clinical Sections */
        .section-title {
            font-family: 'Helvetica Neue', sans-serif;
            color: #004a99;
            border-bottom: 2px solid #eee;
            padding-bottom: 8px;
            margin: 25px 0 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 18px;
        }

        /* Print Optimization */
        @media print {
            body {
                padding: 0;
                font-size: 12pt;
            }

            .container {
                padding: 15px;
                min-height: auto;
                page-break-after: always;
                box-shadow: none;
            }

            .patient-info-card {
                background: none;
               
            }

            .buttons {
                display: none;
            }

            .no-print {
                display: none;
            }

            input[type="date"] {
                appearance: none;
                -webkit-appearance: none;
                -moz-appearance: none;
                border: none;
                padding: 0;
                background: transparent;
                font-family: 'Helvetica Neue', sans-serif;
                font-size: 12pt;
                color: #333;
                width: auto;
           
                font-size: 15px;
                margin-left: 20px;
            }

            input[type="date"]::-webkit-calendar-picker-indicator {
                display: none;
            }

            input[type="date"]:before {
                content: attr(value);
            }

            .print-checkbox {
                display: inline-block;
                margin-right: 5px;
            }
            .signature {
                text-align: right;
                font-style: italic;
            }
            .signature::before {
                content: "_______________";
                display: block;
                margin-bottom: 10px;
                margin-top: 100px;
            }
            
            .navbar .buttons button {
                display: none;
            }
        }

        .procedure-table {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
        }

        .procedure-box {
            flex: 1;
            min-width: 200px;
            max-width: 220px;
            border: 1px solid black;
            padding: 8px;
            text-align: left;
            font-size: 12px;
            line-height: 1.2;
            background: #f8f9fa;
            height: 280px;
        }

        .procedure-box strong {
            font-size: 13px;
        }

        .procedure-box ol {
            padding-left: 15px;
        }

        .procedure-box li {
            font-size: 12px;
            margin-bottom: 3px;
        }

        .table th, .table td {
            border: 1px solid black;
            padding: 5px;
            text-align: center;
            font-size: 14px;
        }

        .iol-sticker {
            margin-top: 10px;
            border: 1px solid black;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
        }

        /* Navbar Styling */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f8f8f8;
            padding: 5px 10px;
        }

        .navbar img {
            height: 50px;
            margin-left: 20px;
        }

        .navbar .buttons {
            display: flex;
            gap: 10px;
        }

        .navbar .buttons button {
            padding: 8px 16px;
            font-size: 14px;
            background: #d32f2f;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
 /* Custom CSS for the table */
 .table-container {
            width: 100%;
            margin: 20px auto;
            border-collapse: collapse;
        }

        .table-container th,
        .table-container td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        .table-container th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .table-container tbody tr:hover {
            background-color: #f1f1f1;
        }





           /* Print-specific styling */
    @media print {
        .print-investigation {
            margin-top: 100%; /* Add top margin for printing */
        }
    }

  /* Print-specific styles */
@media print {
    /* Style for text inputs */
    input[type="text"] {
        border: none !important;
        background: transparent !important;
        -webkit-appearance: none;
        appearance: none;
        box-shadow: none;
        padding: 0;
        position: relative; /* Added for positioning control */
    }
    
    /* Display the input value with left alignment */
    input[type="text"]::after {
        content: attr(value);
        display: block;
        text-align: start; /* Explicitly aligns text to the left */
        position: absolute;
        left: 0; /* Positions at the start */
        width: 100%; /* Maintains full width */
        color: black; /* Ensures text is visible */
        font-family: inherit; /* Inherits the font from the input */
        font-size: inherit; /* Inherits the font size from the input */
    }
    
   
    
    /* Optional: Ensure labels or static text are visible */
    label {
        color: black !important;
    }
}

    </style>
</head>
<body>
    <nav class="navbar">
        <!-- Logo and Hospital Name -->
        <div style="display: flex; align-items: center;">
           
          
        </div>
           
        </div>
    
        <!-- Image on the Right Side -->
        
    
        <!-- Action Buttons -->
        <div class="buttons" style="margin-bottom: 10px;">
            <button onclick="window.location.href='./main.html';">üè† Home</button>
            <button onclick="printFunction()" >üñ®Ô∏è Print Discharge Card </button>
        </div>
    </nav>

    <div class="container">
        <!-- Letterhead -->
        <div class="letterhead">
            <div style="margin-left: 120px;">
                <img src="../assets/images/Ravikalp_Hospital__new_logo-removebg-preview.png" alt="Hospital Logo" class="hospital-logo">
            </div>
            <div class="hospital-info" style="margin-right: 23%;">
                <div class="hospital-name">‡§∞‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§π‡•â‡§∏‡•ç‡§™‡§ø‡§ü‡§≤</div>
                <div class="hospital-address" style="margin-right: 0px;">EYE & GENERAL HOSPITAL<br>PHACO & LASER CENTER</div>
            </div>
        </div>

        <!-- Patient Information -->
          <!-- Patient Information -->
          <div class="patient-info-card">
            <table class="table table-bordered patient-table">
                <tbody>
                    <tr>
                        <th>Patient ID:</th>
                        <td id="patient-id"></td>
                        <th>Name:</th>
                        <td id="patient-name">Pratham Ganesh Mistari</td>
                    </tr>
                    <tr>
                        <th>Age:</th>
                        <td id="patient-age">40 yrs</td>
                        <th>Gender:</th>
                        <td id="patient-gender">Male</td>
                    </tr>
                    <tr>
                        <th>Date of Birth:</th>
                        <td id="patient-dob">N/A</td>
                        <th>Address:</th>
                        <td id="patient-address">N/A</td>
                        
                    </tr>
                    <tr>
                        <th>Admission Date:</th>
                        <td>
                            <input type="date" id="admission-input" oninput="updateDateField(this, 'admission-value')">
                        </td>
                        <th>Discharge Date:</th>
                        <td>
                            <input type="date" id="discharge-input" oninput="updateDateField(this, 'discharge-value')">
                        </td>
                
                    </tr>
                    <tr>
                        <th>Surgeon Name:</th>
                        <td>Dr. Alvin R Rane</td>
                        <th>Surgery Name:</th>
                        <td class="show-SurgicalTreatment">Cataract Surgery</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Diagnosis Section -->
        <h4 class="section-title">Diagnosis</h4>
        <div class="d-flex flex-wrap gap-2 show-diagnosis">
            <!-- Diagnosis will be dynamically populated here -->
        </div>

        <!-- Operative Notes Section -->
        <h4 class="section-title">OPERATIVE NOTES</h4>
        <div class="procedure-table">
            <div class="procedure-box">
                <input type="checkbox" class="print-checkbox" id="phaco-check"> <strong>Phaco</strong>
                <ol>
                    <li>P & D With Betadin Solution.</li>
                    <li>Site Port with 15 Blade.</li>
                    <li>Incision clear corneal 2.2mm / 2.8mm.</li>
                    <li>Anterior capsule stain with Blue-dye.</li>
                    <li>Capsulorhexis done with cystotome.</li>
                    <li>Hydrodelineation & Hydrodissection done.</li>
                    <li>Phaco-Treaching & Aspiration with Phaco Probe.</li>
                    <li>Foldable IOL kept in Bag.</li>
                    <li>Wound Hydrated.</li>
                    <li>Eye Patched.</li>
                </ol>
            </div>
            <div class="procedure-box">
                <input type="checkbox" class="print-checkbox" id="sics-check"> <strong>SICS</strong>
                <ol>
                    <li>P & D Dropping with Betadine.</li>
                    <li>Conjunctival Flap Done.</li>
                    <li>Tunnel with crescent Blade.</li>
                    <li>Site port with 15 No Blade.</li>
                    <li>Capsulorhexis with cystotome.</li>
                    <li>Main entry done with 3.2 Blade.</li>
                    <li>Hydrodissection done.</li>
                    <li>Nucleus delivery with vectis.</li>
                    <li>Cortex aspiration with symcoe cannula.</li>
                    <li>PCL kept in Bag.</li>
                    <li>Wound Hydrated.</li>
                    <li>Subconj inj. given.</li>
                    <li>Eye Patched.</li>
                </ol>
            </div>
            <div class="procedure-box">
                <input type="checkbox" class="print-checkbox" id="pterygium-check"> <strong>Pterygium</strong>
                <ol>
                    <li>P & D Done.</li>
                    <li>Subconj inj. given.</li>
                    <li>Main Mass separated from cornea.</li>
                    <li>Pungium Excised.</li>
                    <li>Superiority graft Separates & Put on excised area.</li>
                    <li>Clint instilled.</li>
                    <li>Eye Patched.</li>
                </ol>
            </div>
        </div>

        <!-- A-Scan Table -->
        <h4 class="section-title" id="A-Scan-Heading">A-Scan Report</h4>
        <table class="table" style="width: 450px; margin: 0 auto;" id="A-Scan-Table">
            <thead>
                <tr>
                    <th></th>
                    <th>Right</th>
                    <th>Left</th>
                </tr>
            </thead>
            <tbody>
                <tr style="height: 10px;"> 
                    <td style="font-size: 12px;">K1</td>
                    <td id="RightK1" style="font-size: 11px;"></td>
                    <td id="LeftK1" style="font-size: 11px;"></td>
                </tr>
                <tr style="height: 15px;"> 
                    <td style="font-size: 12px;">K2</td>
                    <td id="RightK2" style="font-size: 11px;"></td>
                    <td id="LeftK2" style="font-size: 11px;"></td>
                </tr>
                <tr style="height: 15px;">
                    <td style="font-size: 11px;" >LT</td>
                    <td style="font-size: 11px;"id="RightLT"></td>
                    <td style="font-size: 11px;"id="LeftLT"></td>
                </tr> 

                
                <tr style="height: 15px;"> 
                    <td style="font-size: 11px;">AXL</td>
                    <td id="RightAL" style="font-size: 11px;"></td>
                    <td id="LeftAL" style="font-size: 11px;"></td>
                </tr>

                 <tr style="height: 15px;"> 
                    <td style="font-size: 11px;">ACD</td>
                    <td style="font-size: 11px;" id="RightACD"></td>
                    <td style="font-size: 11px;" id="LeftACD"></td>
                </tr> 

                <tr style="height: 15px;">
                    <td style="font-size: 11px;">L.Power</td>
                    <td style="font-size: 11px;" id="RightLPower">1</td>
                    <td style="font-size: 11px;" id="LeftLPower">1</td>
                </tr>

                 <tr style="height: 15px;"> 
                    <td style="font-size: 11px;" >A.Constant</td>
                    <td style="font-size: 11px;" id="RightAConstant"></td>
                    <td style="font-size: 11px;" id="LeftAConstant"></td>
                </tr>

                <tr style="height: 15px;"> 
                    <td style="font-size: 11px;">IOL</td>
                    <td id="RightIOL" style="font-size: 11px;"></td>
                    <td id="LeftIOL" style="font-size: 11px;"></td>
                </tr>

            </tbody>
        </table>

        <!-- Investigation Section -->
        <h4 class="section-title" id="investigation-title">Investigation</h4>
        <div class="investigation-container">
            <div class="investigation-list">
                <!-- Investigations will be dynamically populated here -->
            </div>
        </div>
        <!-- IOL Sticker Section -->
        <h4 class="section-title">IOL STICKER</h4>
        <div class="iol-sticker" style="width: 380px; margin: 0 auto; height: 150px;"></div>

        <!-- Post Operative Treatment Section -->
      
        <!-- <div class="d-flex align-items-center" style="margin-top: 20px;">
            <label for="surgeonName" class="form-label me-2" style="margin-left: 140px;"><strong>Gatiquin-P Eye Drop :</strong></label>
            <input type="text" class="form-control" style="width: 200px;">
        </div>
        <div class="d-flex align-items-center" style="margin-top: 20px;">
            <label for="surgeonName" class="form-label me-2" style="margin-left: 140px;"><strong>Homide Eye Drop :</strong></label>
            <input type="text" class="form-control" style="width: 200px;">
        </div>
        <div class="d-flex align-items-center" style="margin-top: 20px;">
            <label for="surgeonName" class="form-label me-2" style="margin-left: 140px;"><strong>Tobastar Eye Drop :</strong></label>
            <input type="text" class="form-control" style="width: 200px;">
        </div> -->

        <div class="patient-details Pre-Operative-Details" >
                      
        <h4 class="section-title " >Pre-Operative Workup Investigations</h4>  
            <p class="complaints show-BP"  style="margin-right: 120px;">

            </p>

            <p class="complaints show-Pulse-Rate" style="margin-right: 120px;">
                
            </p>
            <p class="complaints show-SAC" style="margin-right: 120px;">
                
            </p>
            <p class="complaints show-NCT" style="margin-right: 120px;">
              
          </p>                                          
    </div>
    <table id="Pre-Operative-Table" style="width: 470px; margin-left: 90px; border-collapse: collapse; text-align: center; border: 1px solid #000;">
        <h4 class="section-title "id="Pre-Operative-Heading" >NCT</h4>  
        <thead>
            <tr style="background-color: #f0f0f0; border: 1px solid #000;">
                <th colspan="2" style="padding: 8px; border: 1px solid #000;">Right Eye</th>
                <th colspan="2" style="padding: 8px; border: 1px solid #000;">Left Eye</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="input-wrapper" style="padding: 5px; border: 1px solid #000;">
                    <span id="RightmmHg">Data</span>
                    <span>mmHg</span>
                </td>
                <td style="padding: 5px; border: 1px solid #000;">
                    <span id="RightmmHgTime">00:00</span>
                </td>
                <td class="input-wrapper" style="padding: 5px; border: 1px solid #000;">
                    <span id="LeftmmHg">Data</span>
                    <span>mmHg</span>
                </td>
                <td style="padding: 5px; border: 1px solid #000;">
                    <span id="LeftmmHgTime">00:00</span>
                </td>
            </tr>
        </tbody>
    </table>
    

    <h4 class="section-title " id="Medicines-Heading">Post Operative Treatment</h4>
    <table class="table table-responsive table-bordered" id="Medicines-Table" style="width: 500px; margin: 0 auto; background-color: #f9f9f9;">
        <thead>
            <tr>
                <th scope="col" class="text-center fw-bold" style="background-color: #e0e0e0; padding: 10px;">Medicine Name</th>
                <th scope="col" class="text-center fw-bold" style="background-color: #e0e0e0; padding: 10px;">Dose</th>
            </tr>
        </thead>
        <tbody id="medicines-tbody">
            <!-- Medicines will be dynamically inserted here -->
            <tr>
                <td class="text-start" style="padding: 10px;">Aspirin</td>
                <td class="text-start" style="padding: 10px;">500mg</td>
            </tr>
            <tr>
                <td class="text-start" style="padding: 10px;">Paracetamol</td>
                <td class="text-start" style="padding: 10px;">1000mg</td>
            </tr>
        </tbody>
    </table>
    
    <style>
        /* Custom CSS to match original border thickness and collapse */
        .table-bordered th,
        .table-bordered td {
            border: 2px solid black !important;
            border-collapse: collapse !important;
        }
    
        /* Ensure table responsiveness and background */
        #Medicines-Table {
            background-color: #f9f9f9;
        }
    </style>
  <div class="footer" style="color: black;">
            <div class="signature" style="margin-right: 30px;">
                <p>Dr. Alvin R Rane</p>
            </div>
        </div>

        
    </div>
<script>
     const tempDateStr = localStorage.getItem("tempDate");
     function printFunction() {
            const patientId = "P"+appointment.id;
            // Get todays date with dd-mm-yyyy format
            let today;
            if (tempDateStr) {
                today = new Date(...tempDateStr.split("/").reverse().map((v, i) => (i === 1 ? v - 1 : +v)));
            } else {
                today = new Date(); // Ensure `today` is always a Date object
            }
            const date = today.toLocaleDateString("en-GB").replace(/\//g, "-");
            const Docname = patientId+"_DischargeCard" + "_" + date;

            console.log(patientId,date,Docname);

            window.electronAPI.printPage(patientId, date, Docname);
        }
     // Retrieve the appointment object from localStorage
     const appointment = JSON.parse(window.localStorage.getItem("appointment")) || {};

       // Function to format date from YYYY-MM-DD to DD-MM-YYYY
    function formatDate(isoDate) {
        if (!isoDate) return "N/A";  // Return "N/A" if date is missing
        const [year, month, day] = isoDate.split("-");
        return `${day}-${month}-${year}`;
    }

    // Update the HTML elements with appointment data
    document.getElementById("patient-id").textContent = appointment.id || "N/A";
    document.getElementById("patient-name").textContent = appointment.Name || "N/A";
    document.getElementById("patient-age").textContent = appointment.Age ? appointment.Age + " yrs" : "N/A";
    document.getElementById("patient-gender").textContent = appointment.Gender || "N/A";
    document.getElementById("patient-dob").textContent = appointment.BirthDate || "N/A";
    document.getElementById("patient-dob").textContent = formatDate(appointment.BirthDate);
    document.getElementById("patient-address").textContent = appointment. Address || "N/A";

    // Retrieve selected SurgicalTreatment from localStorage
    const selectedSurgicalTreatment = JSON.parse(localStorage.getItem("selectedSurgicalTreatment")) || [];

    // Display selected SurgicalTreatment in the "SurgicalTreatment" section
    // Get the SurgicalTreatment display section
    const SurgicalTreatmentSection = document.querySelector(".show-SurgicalTreatment");
    // Only update if there are SurgicalTreatment to show
    if (selectedSurgicalTreatment.length > 0) {
        SurgicalTreatmentSection.innerHTML = selectedSurgicalTreatment.join(' <span style="font-weight: bold; color: black;">|</span> ');
    } else {
        SurgicalTreatmentSection.innerHTML = `N/A`;
    }

   

    // Retrieve selected diagnoses from localStorage
    const selectedDiagnosis = JSON.parse(localStorage.getItem("selectedDiagnosis")) || [];

    // Display selected diagnoses in the "Diagnosis" section
    // Get the diagnosis display section
    const diagnosisSection = document.querySelector(".show-diagnosis");
    // Only update if there are diagnoses to show
    if (selectedDiagnosis.length > 0) {
        diagnosisSection.innerHTML = `
        
            ${selectedDiagnosis.join(' <span style="font-weight: bold; color: black;">|</span> ')}
        `;
    } else {
        diagnosisSection.innerHTML = `
        
            N/A
        `;
    }

    // Load the A-Scan table from local storage 
    const aScanTable = JSON.parse(localStorage.getItem("aScanTable")) || {};
        
        // Get table and heading elements
        const aScanTableElement = document.getElementById("A-Scan-Table");
        const aScanHeading = document.getElementById("A-Scan-Heading");
        const aScanRows = aScanTableElement.querySelectorAll("tbody tr");

        // Define the mapping for each row and its respective keys in aScanTable
        const aScanRowMapping = [
        { rowIndex: 0, rightKey: "RightK1", leftKey: "LeftK1" },
            { rowIndex: 1, rightKey: "RightK2", leftKey: "LeftK2" },
            { rowIndex: 2, rightKey: "RightLT", leftKey: "LeftLT" },
            { rowIndex: 3, rightKey: "RightAL", leftKey: "LeftAL" },
            { rowIndex: 4, rightKey: "RightACD", leftKey: "LeftACD" },
            { rowIndex: 5, rightKey: "RightLPower", leftKey: "LeftLPower" },
            { rowIndex: 6, rightKey: "RightAConstant", leftKey: "LeftAConstant" },
            { rowIndex: 7, rightKey: "RightIOL", leftKey: "LeftIOL" }
        ];

        let visibleAScanRowCount = 0;

        aScanRowMapping.forEach(({ rowIndex, rightKey, leftKey }) => {
            const rightValue = aScanTable[rightKey] || "";
            const leftValue = aScanTable[leftKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                aScanRows[rowIndex].style.display = "none";
            } else {
                aScanRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                aScanRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "-";
                aScanRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "-";
                visibleAScanRowCount++;
            }
        });


        // Show or hide the entire table if all rows are hidden
        aScanTableElement.style.display = visibleAScanRowCount > 0 ? "table" : "none";

        // Show or hide the heading based on whether the table is visible
        aScanHeading.style.display = visibleAScanRowCount > 0 ? "block" : "none";

// Retrieve selected investigations from localStorage
const selectedInvestigations = JSON.parse(localStorage.getItem("selectedInvestigation")) || [];

// Get the investigation display container
const investigationContainer = document.querySelector(".investigation-list");

// Only update if there are investigations to show
if (selectedInvestigations.length > 0) {
    // Clear existing content
    investigationContainer.innerHTML = "";

    // Add each investigation with an input box
    selectedInvestigations.forEach((investigation) => {
        const investigationItem = document.createElement("div");
        investigationItem.classList.add("investigation-item");

        investigationItem.innerHTML = `
            <span>${investigation}:</span>
            <input type="text" class="small-input">|
        `;

        investigationContainer.appendChild(investigationItem);
    });
} else {
    // Hide investigation section and title
    document.getElementById("investigation-title").style.display = "none";
    investigationContainer.style.display = "none";
}

</script>
<script>
    function updatePrintDate(inputId, spanId) {
        let dateValue = document.getElementById(inputId).value;
        if (dateValue) {
            document.getElementById(spanId).textContent = formatDate(dateValue);
        }
    }

    function formatDate(dateStr) {
        let date = new Date(dateStr);
        let day = date.getDate().toString().padStart(2, '0'); // Ensure 2 digits
        let month = (date.getMonth() + 1).toString().padStart(2, '0'); // Ensure 2 digits
        let year = date.getFullYear();
        return `${day}/${month}/${year}`; // Format: DD/MM/YYYY
    }







        // Load the medicines table from local storage
        const medicines = JSON.parse(localStorage.getItem("medicines")) || [];

        const medicinesTable = document.getElementById("Medicines-Table");
        const medicinesTbody = medicinesTable.querySelector("tbody");
        const medicinesHeading = document.getElementById("Medicines-Heading");

        if (medicines.length === 0) {
            // Hide the table if no medicines are selected
            medicinesTable.style.display = "none";
            medicinesHeading.style.display = "none";

        } else {
            // Show the table and update the content
            medicinesTable.style.display = "table";

            // Clear the existing table body
            medicinesTbody.innerHTML = "";

            // Add each medicine as a row in the table
            medicines.forEach((medicine) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${medicine.medicineSelect || "-"}</td>
                    <td>${medicine.medicineDose || "-"}</td>
                  
                `;
                medicinesTbody.appendChild(row);
            });
        }


    


     // Show or hide the entire table if all rows are hidden
     aScanTableElement.style.display = visibleAScanRowCount > 0 ? "table" : "none";

// Show or hide the heading based on whether the table is visible
aScanHeading.style.display = visibleAScanRowCount > 0 ? "block" : "none";


// Load PreOperativeDetails data from local storage
const preOperativeDetails = JSON.parse(localStorage.getItem("PreOperativeDetails")) || {};

// Define field mappings
const fieldMappings = [
    { key: "BPResult", className: "show-BP", label: "BP" },
    { key: "PulseRate", className: "show-Pulse-Rate", label: "P" },
    { key: "SACResult", className: "show-SAC", label: "SAC" },
    { key: "NCTResult", className: "show-NCT", label: "NCT" }
];

let visibleCount = 0;

// Iterate through each field and update the content
fieldMappings.forEach(({ key, className, label }) => {
    const element = document.querySelector(`.${className}`);

    if (element) {
        const value = preOperativeDetails[key]?.trim() || ""; // Trim to remove whitespace

        if (value) {
            element.innerHTML = `<span style="font-weight: bold; font-size: 17px;">${label} :</span> ${value}`;
            visibleCount++;
        } else {
            element.style.display = "none"; // Hide element if value is empty
        }
    }
});

// Hide the entire section if no details are available
const patientDetailsSection = document.querySelector(".Pre-Operative-Details");
if (visibleCount === 0 && patientDetailsSection) {
    patientDetailsSection.style.display = "none";
}











        // Load IOP/GAT data from local storage like eye examination table
        const iopGatTable = JSON.parse(localStorage.getItem("iopGatTable")) || {};

        // Get table and heading elements
        const iopGatTableElement = document.getElementById("Pre-Operative-Table");
        const iopGatHeading = document.getElementById("Pre-Operative-Heading");

        // Get all rows in the IOP/GAT table body
        const iopGatRows = iopGatTableElement.querySelectorAll("tbody tr");

        // Define row mappings
        const iopGatRowMappings = [
            { rowIndex: 0, rightKey: "RightmmHg", rightTimeKey: "RightmmHgTime", leftKey: "LeftmmHg", leftTimeKey: "LeftmmHgTime" }
        ];

        let visibleIopGatRowCount = 0;

        // Iterate through each row mapping and update table cells

        iopGatRowMappings.forEach(({ rowIndex, rightKey, rightTimeKey, leftKey, leftTimeKey }) => {
            const rightValue = iopGatTable[rightKey] || "";
            const rightTimeValue = iopGatTable[rightTimeKey] || "";
            const leftValue = iopGatTable[leftKey] || "";
            const leftTimeValue = iopGatTable[leftTimeKey] || "";

            // Hide the row if both values are empty
            if (rightValue === "" && leftValue === "") {
                iopGatRows[rowIndex].style.display = "none";
            } else {
                iopGatRows[rowIndex].style.display = ""; // Ensure it's visible if not empty
                iopGatRows[rowIndex].querySelector(`#${rightKey}`).textContent = rightValue || "-";
                iopGatRows[rowIndex].querySelector(`#${rightTimeKey}`).textContent = rightTimeValue || "-";
                iopGatRows[rowIndex].querySelector(`#${leftKey}`).textContent = leftValue || "-";
                iopGatRows[rowIndex].querySelector(`#${leftTimeKey}`).textContent = leftTimeValue || "-";
                visibleIopGatRowCount++;
            }
        });

        // Show or hide the entire table based on row visibility
        iopGatTableElement.style.display = visibleIopGatRowCount > 0 ? "table" : "none";
        iopGatHeading.style.display = visibleIopGatRowCount > 0 ? "block" : "none";
</script>




</body>
</html>